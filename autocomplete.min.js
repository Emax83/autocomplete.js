!function () { function e(e, n) { !function (e) { var n = ++t + "" }("cp"); var o, i, r, a = e.get(0), l = n.strict || !1, s = (n.valueField, n.textField, n), f = n.target || e.data("target"), u = n.minLen || 3, c = n.errorClass, d = (n.className, n.itemClassName), v = n.selectedItemClassName, p = document, m = p.createElement("div"), h = m.style, g = navigator.userAgent, y = -1 !== g.indexOf("Firefox") && -1 !== g.indexOf("Mobile"), L = n.debounceWaitMs || 0, C = n.preventSubmit || !1, x = y ? "input" : "keyup", E = [], w = [], b = "", N = n.showOnFocus, T = 0, D = !1, k = !1, O = n.init; n.onSelect, n.fetch; if ($(a).attr("autocomplete", "off"), "string" == typeof (w = void 0 === n.list ? this.data("list") : n.list)) { var S = $(w); if (!S) return void console.error("Non riesco a trovare l'elemento con id '" + this.list + "' per recuperare i valori di autocomplete"); w = [], $(S).children().each(function (e) { let t = $(this).val(), n = $(this).text(); t !== n ? w.push({ value: t, text: n }) : w.push(t) }) } if ((r = O) && "function" == typeof r && r(), w && "" !== w) return void 0 === n.fetch && (n.fetch = function (e) { e = e.toLowerCase(); E = w.filter(function (e) { return function (t) { return "string" == typeof t ? t.toLowerCase().indexOf(e) > -1 : t.text.toLowerCase().indexOf(e) > -1 } }(e)), A() }), m.className = "autocomplete " + (n.className || ""), m.addEventListener("mousedown", function (e) { e.stopPropagation(), e.preventDefault() }), m.addEventListener("focus", function () { return a.focus() }), a.addEventListener("keydown", B), a.addEventListener(x, M), a.addEventListener("blur", j), a.addEventListener("focus", G), window.addEventListener("resize", V), p.addEventListener("scroll", I, !0), { destroy: function () { a.removeEventListener("focus", G), a.removeEventListener("keydown", B), a.removeEventListener(x, M), a.removeEventListener("blur", j), window.removeEventListener("resize", V), p.removeEventListener("scroll", I, !0), F(), z() } }; function F() { i && window.clearTimeout(i) } function H() { return !!m.parentNode } function z() { var e; T++ , E = [], b = "", o = void 0, (e = m.parentNode) && e.removeChild(m) } function A() { for (k = !0; m.firstChild;)m.removeChild(m.firstChild); var e = function (e, t) { var n = p.createElement("div"); return "string" == typeof e ? n.textContent = e || "" : (n.textContent = e.text || "", n.setAttribute("data-value", e.text)), n.className = d, n }; s.render && (e = s.render); var t = function (e, t) { var n = p.createElement("div"); return n.textContent = e, n }; s.renderGroup && (t = s.renderGroup); var i = p.createDocumentFragment(), r = "#9?$"; if (E.forEach(function (n) { if (n.group && n.group !== r) { r = n.group; var l = t(n.group, b); l && (l.className += " group", i.appendChild(l)) } var s = e(n, b); s && (s.addEventListener("click", function (e) { o = a, U(n, a), z(), e.preventDefault(), e.stopPropagation() }), n === o && (s.className += " selected " + v), i.appendChild(s)) }), m.appendChild(i), E.length < 1) { if (!s.emptyMsg) return void z(); var l = p.createElement("div"); l.className = "empty", l.textContent = s.emptyMsg, m.appendChild(l) } m.parentNode || p.body.appendChild(m), function () { if (H()) { h.position = "absolute", $(a).parentsUntil(".modal").length > 0 && (h.zIndex = 1100), h.height = "auto", h.width = a.offsetWidth + "px"; var e, t = 0; o(), o(), n.customize && e && n.customize(a, e, m, t) } function o() { var n = p.documentElement, o = n.clientTop || p.body.clientTop || 0, i = n.clientLeft || p.body.clientLeft || 0, r = window.pageYOffset || n.scrollTop, l = window.pageXOffset || n.scrollLeft, s = (e = a.getBoundingClientRect()).top + a.offsetHeight + r - o, f = e.left + l - i; h.top = s + "px", h.left = f + "px", (t = window.innerHeight - (e.top + a.offsetHeight)) < 0 && (t = 0), h.top = s + "px", h.bottom = "", h.left = f + "px", h.maxHeight = t + "px" } }(), function () { var e = m.getElementsByClassName("selected"); if (e.length > 0) { var t = e[0], n = t.previousElementSibling; if (n && -1 !== n.className.indexOf("group") && !n.previousElementSibling && (t = n), t.offsetTop < m.scrollTop) m.scrollTop = t.offsetTop; else { var o = t.offsetTop + t.offsetHeight, i = m.scrollTop + m.offsetHeight; o > i && (m.scrollTop += o - i) } } }() } function P() { H() && A() } function V() { P() } function I(e) { e.target !== m ? P() : e.preventDefault() } function M(e) { for (var t = e.which || e.keyCode || 0, n = 0, o = [38, 13, 27, 39, 37, 16, 17, 18, 20, 91, 9]; n < o.length; n++) { if (t === o[n]) return } t >= 112 && t <= 123 || 40 === t && H() || W(0) } function U(e, t) { o = e, D = !0, l && (t.setCustomValidity(""), t.classList.remove(c)), "string" == typeof o ? t.value = o : (t.value = o.text, $(t).val(o.text), $(t).data("value", o.value)), s.onSelect && s.onSelect(o, t, f) } function B(e) { D = !1; var t = e.which || e.keyCode || 0; if (38 === t || 40 === t || 27 === t) { var n = H(); if (27 === t) z(); else { if (!H || E.length < 1) return; 38 === t ? function () { if (E.length < 1) o = void 0; else if (o === E[0]) o = E[E.length - 1]; else for (var e = E.length - 1; e > 0; e--)if (o === E[e] || 1 === e) { o = E[e - 1]; break } }() : function () { if (E.length < 1 && (o = void 0), o && o !== E[E.length - 1]) { for (var e = 0; e < E.length - 1; e++)if (o === E[e]) { o = E[e + 1]; break } } else o = E[0] }(), A() } return e.preventDefault(), void (n && e.stopPropagation()) } 13 === t && (o && (e.preventDefault(), e.stopPropagation(), U(o, a), z()), C && e.preventDefault()), 9 === t && l && (o ? (U(o, a), z()) : D = !1) } function G() { N && W(1) } function W(e) { var t = ++T, n = a.value; n.length >= u || 1 === e ? (F(), i = window.setTimeout(function () { s.fetch(n, function (e) { T === t && e && (b = n, o = (E = e).length > 0 ? E[0] : void 0, A()) }, 0) }, 0 === e ? L : 0)) : z() } function j() { setTimeout(function () { p.activeElement !== a && z() }, 200), !0 === l & !1 === D & !0 === k && (E.length > 1 & !E.includes(a.value) ? (a.classList.add(c), a.setCustomValidity("Invalid field.")) : 1 === E.length & a.value.length >= u ? (a.value = o, a.classList.remove(c), a.setCustomValidity("")) : 0 === E.length & a.value.length >= u ? (a.classList.add(c), a.setCustomValidity("Invalid field.")) : 0 === E.length & 0 === a.value.length && (a.classList.remove(c), a.setCustomValidity(""))) } console.error("Per attivare l'autocomplete Ã¨ necessario provvedere una lista di stringhe o un oggetto datalist.") } var t = 0; e.DEFAULTS = {}, $.fn.autocomplete = function (t) { var n = Array.prototype.slice.call(arguments, 1); return this.each(function () { var o = $(this), i = o.data("autocomplete"); if (i) "function" == typeof i[t] && i[t].apply(i, n); else { var r = $.extend({}, e.DEFAULTS, o.data(), "object" == typeof t && t); o.data("autocomplete", new e(o, r)) } }) } }();
